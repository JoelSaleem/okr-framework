# Migration `20200627112827`

This migration has been generated by JoelSaleem at 6/27/2020, 11:28:27 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Objective" (
"createdAt" timestamp(3)  NOT NULL ,"description" text   ,"id" SERIAL,"title" text  NOT NULL ,"userId" integer  NOT NULL ,
    PRIMARY KEY ("id"))

ALTER TABLE "public"."KeyResult" DROP CONSTRAINT IF EXiSTS "KeyResult_parentId_fkey1",
DROP CONSTRAINT IF EXiSTS "KeyResult_parentId_fkey",
DROP COLUMN "parentId",
ADD COLUMN "createdAt" timestamp(3)  NOT NULL ,
ADD COLUMN "parentKeyResId" integer   ,
ADD COLUMN "parentObjId" integer   ;

ALTER TABLE "public"."Objecive" DROP CONSTRAINT IF EXiSTS "Objecive_userId_fkey";

ALTER TABLE "public"."Objective" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."KeyResult" ADD FOREIGN KEY ("parentObjId")REFERENCES "public"."Objective"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."KeyResult" ADD FOREIGN KEY ("parentKeyResId")REFERENCES "public"."KeyResult"("id") ON DELETE SET NULL  ON UPDATE CASCADE

DROP TABLE "public"."Objecive";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200627102214..20200627112827
--- datamodel.dml
+++ datamodel.dml
@@ -1,15 +1,15 @@
 datasource postgres {
   provider = "postgres"
-  url = "***"
+  url = "***"
 }
 // This "Example" model has been generated for you by Nexus.
 // Nexus does this when you do not have any models defined.
 // For more detail and examples of working with your Prisma
 // Schema, refer to its complete docs at https://pris.ly/d/prisma-schema.
-model Objecive {
+model Objective {
   id          Int         @id @default(autoincrement())
   title       String
   description String?
   createdAt   DateTime
@@ -18,27 +18,28 @@
   KeyResult   KeyResult[]
 }
 model KeyResult {
-  id              Int        @id @default(autoincrement())
+  id              Int         @id @default(autoincrement())
   title           String
   description     String?
+  createdAt       DateTime
   target          Int
   current         Int
-  user            User       @relation(fields: [userId], references: [id])
+  user            User        @relation(fields: [userId], references: [id])
   userId          Int
-  parentobjective Objecive?  @relation(fields: [parentId], references: [id])
-  parentResult    KeyResult? @relation(fields: [parentId], references: [id])
-  parentId        Int?
-
-  KeyResult KeyResult[] @relation("KeyResultToKeyResult")
+  parentObjective Objective?  @relation(fields: [parentObjId], references: [id])
+  parentResult    KeyResult?  @relation(fields: [parentKeyResId], references: [id])
+  parentObjId     Int?
+  parentKeyResId  Int?
+  KeyResult       KeyResult[] @relation("KeyResultToKeyResult")
 }
 model User {
   id         Int         @id @default(autoincrement())
   email      String      @unique
   password   String
-  objectives Objecive[]
+  objectives Objective[]
   createdAt  DateTime
   KeyResult  KeyResult[]
 }
```


